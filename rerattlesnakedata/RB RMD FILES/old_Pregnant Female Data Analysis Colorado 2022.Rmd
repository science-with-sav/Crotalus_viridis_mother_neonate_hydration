---
title: "Pregnant Female Data Analysis Colorado 2022"
author: "Robin Bedard"
date: '2022-12-01'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Loading required packages
```{r}
`%nin%` = Negate(`%in%`)
library("ggpubr")
library("lme4")
library("dplyr")
library("tidyverse")
library("stringr")
library("tidyr")
library("PerformanceAnalytics")
library("lmerTest")
library("readr")
#library("xlsx")
```

#Merging Osmolarity Data and All Other Measurements 

```{r}
setwd("/Users/robinbedard/Desktop/Thesis/RDS_files")

#Body measurement and measurements that are not replicated
mother_data_final <- read_rds("FinalMotherViridis.RDS") 
#Osmolarity data after outliers were removed and replicates were averaged 
mother_temp_osm <- read_rds("clean_MotherOsmolality.RDS")
##merging the two data frames so osmolarity data is with all other data
mother_data_all_final <- left_join(mother_data_final, mother_temp_osm, by =c("Indiv_ID", "CEWL_Blood_Collect_Date"))
```

Factoring the pregnancy stages so that they are plotted in the proper order. 
```{r}
mother_data_all_final$Preg_Stage <- factor(mother_data_all_final$Preg_Stage, levels = c("DAC", "1WAC", "2WAC", "DAB", "1WAB")) 
```


#Initial Figures (not useful; uninformative) 
Uninformative but keeping just in case
Attempting to make a simple plot of osmolarity data.

```{r}
ggplot(data = mother_data_all_final) +
  geom_boxplot(aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean), fill = "lightblue", color = "black", outlier.fill = "lightgreen", outlier.colour = "black", outlier.shape = 21, outlier.size = 2) +
  facet_wrap(~Preg_Stage) +
  labs(title = "Mean Plasma Osmolality Across Pregnancy Stages",
       subtitle = "by Treatment Group", 
       x = "Hydration Treatment",
       y = "Mean Osmolality (mmol/kg)") +
  stat_summary(aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean), fun = "mean", color= "red", shape = 16) +
  scale_y_continuous(limits = c(250, 380),
                     breaks = seq(from = 250, to = 380, by = 30))
```

```{r}
osmol_means_by_tmt_pregstage <- mother_data_all_final %>%
  group_by(Preg_Stage, Hydration_Trmt) %>%
  summarise(mean = mean(Plasma_Osmol_Rep_mean))

#Making a figure that will have all stages of pregnancy on the x axis, osmolarity on the y axis, then lines for each individual throughout time, lines color coded by treatment group, one thick line representing the means for each treatment group at that stage of pregnancy. 
ggplot() +
  geom_line(data = mother_data_all_final,
            aes(x = Preg_Stage,
                y = Plasma_Osmol_Rep_mean,
                color = Hydration_Trmt,
                group = Indiv_ID),
                alpha = 0.2) +
  geom_line(data = osmol_means_by_tmt_pregstage,
            aes(x = Preg_Stage,
                y = mean,
                color = Hydration_Trmt,
                group = Hydration_Trmt),
            size = 1
            ) +


                #group = Hydration_Trmt,
                #alpha = 1) +
  #stat_smooth(data = mother_data_all_final,
   #           aes(x = Preg_Stage,
    #              y = Plasma_Osmol_Rep_mean,
     #             color = Hydration_Trmt,
      #            group = Hydration_Trmt),
       #       formula = y ~ x,
        #      method = "loess",
           #   se = F,
            #  size = 1.2,
             # alpha = 1 ) +
  theme_classic() +
  labs(title = "Plasma Osmolality Across Pregnancy Stages",
       subtitle = "By Treatment Group",
       x = "Pregnancy Stage",
       y = "Plasma Osmolality (mmol/kg)",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))

```

#Linear Model for Day After Capture Osmolarities
Is there a difference in osmolarity between the treatment group and the control group the day after capture? 

```{r}
DAC_osmol <- mother_data_all_final %>%
  dplyr::filter(Preg_Stage == "DAC")
DAC_osmol_lm <- lm(Plasma_Osmol_Rep_mean ~ Hydration_Trmt, data = DAC_osmol)
summary(DAC_osmol_lm)
```
Yes, there is a significant difference between the control and hydration treatment groups the day after capture (p = 8.36e-05). On average, the hydration treatment osmolarity was 25.025 mmol/kg higher than the control group osmolarity. That is okay. We cannot change this. We don't have control over this. 

#All Data with CEWL
Uploading the RDS file that has ALL of the data to do CEWL analysis. This has all body measurements, all CEWL measurements, and all osmolarity measurements for the mothers. CEWL measurements were analyzed on a separate RMD then joined with other dataframe. 

```{r}
mother_data_all_final_2 <- readRDS("/Users/robinbedard/Desktop/Thesis/RDS_files/mother_data_all_final_2.RDS")
```

##Initial Figures (uninformative)

Simple boxplot for CEWL by treatment group and pregnancy stage. Uninformative.
```{r}
ggplot(data = mother_data_all_final_2) +
  geom_boxplot(aes(x = Hydration_Trmt, y = CEWL_g_m2h), fill = "lightblue", color = "black", outlier.fill = "lightgreen", outlier.colour = "black", outlier.shape = 21, outlier.size = 2) +
  facet_wrap(~Preg_Stage) +
  labs(title = "CEWL Across Pregnancy Stages",
       subtitle = "by Treatment Group", 
       x = "Hydration Treatment",
       y = "CEWL") +
  stat_summary(aes(x = Hydration_Trmt, y = CEWL_g_m2h), fun = "mean", color= "red", shape = 16)
```
Same plot as above but with CEWL data across treatment groups. Need to create the means per pregnancy stage before I can do this. Uninformative.

```{r}
CEWL_means_by_tmt_pregstage <- mother_data_all_final_2 %>%
  group_by(Preg_Stage, Hydration_Trmt) %>%
  summarise(mean = mean(CEWL_g_m2h))

ggplot() +
  geom_line(data = mother_data_all_final_2,
            aes(x = Preg_Stage,
                y = CEWL_g_m2h,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 0.2) +
  geom_line(data = CEWL_means_by_tmt_pregstage,
            aes(x = Preg_Stage,
                y = mean,
                color = Hydration_Trmt,
                group = Hydration_Trmt),
            size = 1) +
  theme_classic() +
  labs(title = "CEWL Across Pregnancy Stages",
       subtitle = "By Treatment Group",
       x = "Pregnancy Stage",
       y = "CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))

```

```{r}
ggplot() +
  geom_line(data = mother_data_all_final_2,
            aes(x = Preg_Stage,
                y = CEWL_g_m2h,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 0.2) +
  stat_smooth(data = mother_data_all_final_2,
              aes(x = Preg_Stage,
              y = CEWL_g_m2h,
              color = Hydration_Trmt,
              group = Hydration_Trmt),
              formula = y ~ x,
              method = "loess") +
  theme_classic() +
  labs(title = "CEWL Across Pregnancy Stages",
       subtitle = "By Treatment Group",
       x = "Pregnancy Stage",
       y = "CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

#Day Relative to Birth
This dataframe includes a column "Day Relative" which is the number of days, relative to the day they gave birth, that the measurements were taken.

```{r}
setwd("/Users/robinbedard/Desktop/Thesis/csv files") 
day_scale <- read.csv("DAY RELATIVE TO DAY OF BIRTH - Sheet1.csv")

day_scale_clean <- day_scale %>%
  mutate(IndivID = as.factor(str_trim(IndivID)),
         CEWL.BloodCollectDate = as.Date(str_trim(CEWL.BloodCollectDate),
                                         format = "%m-%d-%y"),
         DayRelativeToZero = as.numeric(DayRelativeToZero)
  ) %>%
  #rename all column names 
  dplyr::select(Indiv_ID = IndivID, CEWL_Blood_Collect_Date = CEWL.BloodCollectDate, Day_Relative = DayRelativeToZero)  %>%
fill(Indiv_ID)

#joining the final table with the day relative to birth column to create a new final dataset 
mother_data_all_final_3 <- left_join(mother_data_all_final_2, day_scale_clean, by = c("Indiv_ID", "CEWL_Blood_Collect_Date"))
```

##Osmolarity
Averaging the osmolarities by day relative by treatment group
```{r}
osmol_means_by_tmt_dayrelative <- mother_data_all_final_3 %>%
  group_by(Day_Relative, Hydration_Trmt) %>%
  summarise(mean = mean(Plasma_Osmol_Rep_mean))
```

###Inital Osmolarity Figures for Day Relative

Making a plot to standardize the x axis to be the day relative to the day the snakes gave birth. This only includes the individuals who did give birth. This is because it is relative to the day they gave birth so the mothers that did not give birth have NAs for the values. 

```{r}
ggplot() +
  geom_line(data = mother_data_all_final_3,
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 0.2) +
  geom_line(data = osmol_means_by_tmt_dayrelative,
            aes(x = Day_Relative,
                y = mean,
                color = Hydration_Trmt,
                group = Hydration_Trmt),
            size = 1) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton",
       subtitle = "Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```
I see a problem with this graph because all snakes were captured on different days, therefore the start of water treatment varies for the individuals so even the hydration group is messed up by some snakes not yet having water. 

Trying to look at each individual. There is def a better way to do this. 

```{r}
ggplot() +
  geom_line(data = mother_data_all_final_3,
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 0.2) +
  facet_wrap(~Indiv_ID) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton",
       subtitle = "Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

###Individual Figures for Osmolarity Day Relative 
```{r}
#101
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "101", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "101", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -11.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -12, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 101; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#103
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "103", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "103", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 103; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#104
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "104", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "104", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -13.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 104; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#105
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "105", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "105", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 105; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#112
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "112", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "112", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -12.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -13, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 112; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#114
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "114", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "114", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -13, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 114; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#115
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "115", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "115", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 115; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#119
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "119", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "119", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -11.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -12, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 119; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#124
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "124", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "124", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -3.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -15, to = 0, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 124; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#125
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "125", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "125", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -3, to = 10, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 125; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#126
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "126", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "126", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -5.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -16, to = 1, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 126; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#127
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "127", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "127", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -7.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -8, to = 1, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 127; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#128
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "128", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "128", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -1.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -2, to = 8, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 128; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#129
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "129", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "129", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -2, to = 7, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 129; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#131
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "131", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "131", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -3.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 131; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#133
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "133", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "133", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 133; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#134
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "134", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "134", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -3.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 134; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

```{r}
#135
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "135", ],
            aes(x = Day_Relative,
                y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "135", ],
             aes(x = Day_Relative,
                 y = Plasma_Osmol_Rep_mean), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -1, to = 8, by = 1)) +
  labs(title = "Plasma Osmolarity Relative to Day of Parturiton (Indiv. 135; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "Osmolarity")
```

###Figure: No Difference in Osmolarities Day after Birth 

```{r}
ggplot(data = mother_data_all_final_3[mother_data_all_final_3$Preg_Stage == "DAB", ]) +
  geom_boxplot(data = mother_data_all_final_3[mother_data_all_final_3$Preg_Stage == "DAB", ], 
               aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean, fill = Hydration_Trmt)) +
  labs(title = "Plasma Osmolarity Day After Birth",
       subtitle = "by Treatment Group", 
       x = "Hydration Treatment",
       y = "Plasma Osmolality (mmol/kg)") +
  scale_y_continuous(limits = c(280, 360),
                     breaks = seq(from = 280, to = 360, by = 30)) +
stat_compare_means(method = "t.test", aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean)) +
  stat_summary(aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean), fun = "mean", color= "red", shape = 16) +
  theme_classic() +
  theme(legend.position = "none")
```

##CEWL
Repeating everything above but with CEWL

```{r}
CEWL_means_by_tmt_dayrelative <- mother_data_all_final_3 %>%
  group_by(Day_Relative, Hydration_Trmt) %>%
  summarise(mean = mean(CEWL_g_m2h))
```
###Initial CEWL Figures for Day Relative
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_3,
            aes(x = Day_Relative,
                y = CEWL_g_m2h,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 0.2) +
  geom_line(data = CEWL_means_by_tmt_dayrelative,
            aes(x = Day_Relative,
                y = mean,
                color = Hydration_Trmt,
                group = Hydration_Trmt),
            size = 1) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  labs(title = "CEWL Relative to Day of Parturiton",
       subtitle = "Parturiton = Day 0",
       x = "Day",
       y = "CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```
uninformative, same reason as above with osmolarity. Will now separate it out by individual. Like above with Osmolarity.

###Individual Figures for CEWL Day Relative

```{r}
#101
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "101", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "101", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -11.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -12, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 101; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#103
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "103", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "103", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 103; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#104
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "104", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "104", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -13.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 104; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#105
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "105", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "105", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 105; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#112
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "112", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "112", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -12.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -13, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 112; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#114
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "114", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "114", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -13, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 114; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#115
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "115", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "115", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -14, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 115; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#119
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "119", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "119", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -11.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -12, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 119; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#124
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "124", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "124", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -3.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -15, to = 0, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 124; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#125
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "125", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "125", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -3, to = 10, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 125; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#126
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "126", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "126", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -5.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -16, to = 1, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 126; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#127
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "127", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "127", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -7.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -8, to = 1, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 127; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#128
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "128", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "128", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -1.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -2, to = 8, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 128; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#129
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "129", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "129", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -2, to = 7, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 129; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#131
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "131", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "131", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -3.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 131; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#133
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "133", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "133", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 133; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#134
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "134", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "cyan3") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "134", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "cyan3") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  geom_vline(xintercept = -3.5, linetype = "dotted", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 134; Hydration)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

```{r}
#135
ggplot() +
  geom_line(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "135", ],
            aes(x = Day_Relative,
                y = CEWL_g_m2h), color = "coral2") +
  geom_point(data = mother_data_all_final_3[mother_data_all_final_3$Indiv_ID == "135", ],
             aes(x = Day_Relative,
                 y = CEWL_g_m2h), color = "coral2") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  scale_x_continuous(breaks = seq(from = -1, to = 8, by = 1)) +
  labs(title = "CEWL Relative to Day of Parturiton (Indiv. 135; Control)",
       subtitle = "Day of Parturiton = Day 0",
       x = "Day",
       y = "CEWL")
```

###Figure: CEWL Day After Birth by Treatment

```{r}
ggplot(data = mother_data_all_final_3[mother_data_all_final_3$Preg_Stage == "DAB", ]) +
  geom_boxplot(data = mother_data_all_final_3[mother_data_all_final_3$Preg_Stage == "DAB", ], 
               aes(x = Hydration_Trmt, y = CEWL_g_m2h, fill = Hydration_Trmt)) +
  labs(title = "CEWL Day After Birth",
       subtitle = "by Treatment Group", 
       x = "Hydration Treatment",
       y = "CEWL") +
  #scale_y_continuous(limits = c(280, 360),
                    # breaks = seq(from = 280, to = 360, by = 30)) +
  stat_compare_means(method = "t.test", aes(x = Hydration_Trmt, y = CEWL_g_m2h)) +
  stat_summary(aes(x = Hydration_Trmt, y = CEWL_g_m2h), fun = "mean", color= "red", shape = 16) +
  theme_classic() +
  theme(legend.position = "none")
```

#Day Relative to the Number of Days in Treatment

First, uploading the CSV with the new column of days relative to number of days in hydration treatment
```{r}
setwd("/Users/robinbedard/Desktop/Thesis/csv files") 
days_in_tmt <- read.csv("DAYS IN TREATMENT - Sheet1.csv")
```

```{r}
days_in_tmt_clean <- days_in_tmt %>%
  mutate(IndivID = as.factor(str_trim(IndivID)),
         CEWL.BloodCollectDate = as.Date(str_trim(CEWL.BloodCollectDate),
                                         format = "%m-%d-%y"),
         DaysInTrmt = as.numeric(DaysInTrmt),
         GaveBirth = as.factor(GaveBirth)
  ) %>%
  #rename all column names 
  dplyr::select(Indiv_ID = IndivID, CEWL_Blood_Collect_Date = CEWL.BloodCollectDate, Days_in_Treatment = DaysInTrmt, Gave_Birth = GaveBirth)  %>%
  fill(Indiv_ID)
```

Joining the final table with the days in treatment column to create a new final data set 
```{r}
mother_data_all_final_4 <- left_join(mother_data_all_final_3, days_in_tmt_clean, by = c("Indiv_ID", "CEWL_Blood_Collect_Date"))
```

Averaging the osmolarities by days in treatments group
```{r}
osmol_means_by_days_in_tmt <- mother_data_all_final_4 %>%
  group_by(Days_in_Treatment, Hydration_Trmt, Gave_Birth) %>%
  summarise(mean = mean(Plasma_Osmol_Rep_mean))
```

Making a plot to standardize the x axis to be the number of days in treatment. This includes all individuals. 

First, Making a modified copy of the original data to rename the values for the hydration treatment and if they gave brith so the labels are clear in the facet wrap.

```{r}
mother_data_all_final_4_mod <- mother_data_all_final_4 %>%
  # Rename
  mutate(Hydration_Trmt = recode(Hydration_Trmt, "C" = "Control", "W" = "Hydration")) %>%
  mutate(Gave_Birth = recode(Gave_Birth, "Y" = "Gave Birth", "N" = "Did Not Birth"))
```
 
##Osmolarity Figure
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_4_mod,
            aes(x = Days_in_Treatment,
                y = Plasma_Osmol_Rep_mean,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  facet_wrap(~Gave_Birth + Hydration_Trmt) +
  theme_classic() +
  labs(title = "Plasma Osmolarity Relative to Number of Days in Treatment",
       subtitle = "By treatment group and if snake gave birth",
       x = "Days in Treatment",
       y = "Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))

```

#CEWL Figure
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_4_mod,
            aes(x = Days_in_Treatment,
                y = CEWL_g_m2h,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  facet_wrap(~Gave_Birth + Hydration_Trmt) +
  theme_classic() +
  labs(title = "CEWL Relative to Number of Days in Treatment",
       subtitle = "By treatment group and if snake gave birth",
       x = "Days in Treatment",
       y = "CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

#Change in Osmolarity

Now I am trying to get the change in osmolarity to compare the changes over time. 
Downloadeding the sheet to calculate the change is osmolarity for each mother. Then reuploading.

```{r}
write.csv(mother_data_all_final_4, "/Users/robinbedard/Desktop/Thesis/csv files/All.mother.data.csv")

relative_osmolarities <- read.csv("/Users/robinbedard/Desktop/Thesis/csv files/osmol_relative_change.csv")
relative_osmolarities <- relative_osmolarities[ , c(1, 2, 4)]

relative_osmolarities <- relative_osmolarities %>%
  mutate(Indiv_ID = as.factor(str_trim(Indiv_ID)),
         CEWL_Blood_Collect_Date = as.Date(str_trim(CEWL_Blood_Collect_Date),
                                         format = "%m/%d/%y"))

#joining it to the final df
mother_data_all_final_5 <- full_join(mother_data_all_final_4, relative_osmolarities, by = c("Indiv_ID", "CEWL_Blood_Collect_Date"))
```

###Figure: The change in osmolarity for all mothers that gave birth relative to the day of birth
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_5,
            aes(x = Day_Relative,
                y = Change_in_osmol,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  #geom_line(data = relative_osmol_means,
         #   aes(x = Day_Relative,
            #    y = mean,
             #   color = Hydration_Trmt,
              #  group = Hydration_Trmt),
           # size = 1) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey") +
  theme_classic() +
  labs(title = "Change in Plasma Osmolarity Relative to Day of Parturiton",
       subtitle = "Parturiton = Day 0",
       x = "Day",
       y = "Change in Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

###Figure: The change in osmolarity for all mothers that gave birth relative to the number of days in treatment
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_5,
            aes(x = Days_in_Treatment,
                y = Change_in_osmol,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  labs(title = "Change in Plasma Osmolarity Relative to Number of Days in Tmt",
       x = "Days in Treatment",
       y = "Change in Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

###Figure: The change in osmolarity relative to the number of days in treatment. Separated out by mothers who gave birth and hydration treatment 

```{r}
ggplot() +
  geom_line(data = mother_data_all_final_5,
            aes(x = Days_in_Treatment,
                y = Change_in_osmol,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  facet_wrap(~Gave_Birth + Hydration_Trmt) +
theme_classic() +
  labs(title = "Change in Plasma Osmolarity Relative to Number of Days in Treatment",
       subtitle = "By treatment group and if snake gave birth",
       x = "Days in Treatment",
       y = "Change in Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```


###Figure: The change in osmolarity relative to the number of days in treatment separated out by snakes that did and did not give birth
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_5,
            aes(x = Days_in_Treatment,
                y = Change_in_osmol,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  facet_wrap(~Gave_Birth) +
  theme_classic() +
  labs(title = "Change in Plasma Osmolarity Relative to Number of Days in Treatment",
       subtitle = "By treatment group and if snake gave birth",
       x = "Days in Treatment",
       y = "Change in Osmolarity",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

##Change in CEWL

```{r}
relative_cewl <- read.csv("/Users/robinbedard/Desktop/Thesis/csv files/mother_changecewl.csv")
  
relative_cewl <- relative_cewl[ , c(1, 2, 4, 5)]
  
relative_cewl <- relative_cewl %>%
    mutate(Indiv_ID = as.factor(str_trim(Indiv_ID)),
           CEWL_Blood_Collect_Date = as.Date(str_trim(CEWL_Blood_Collect_Date),
                                             format = "%m/%d/%y"))
  
mother_data_all_final_6 <- full_join(mother_data_all_final_5, relative_cewl, by = c("Indiv_ID", "CEWL_Blood_Collect_Date"))

relative_osmol_means <- mother_data_all_final_6 %>%
  group_by(Day_Relative, Hydration_Trmt) %>%
  summarise(mean = mean(Change_in_osmol))
```

###Figure: The change of CEWL relative to the number of days in treatment for the two treatment groups 
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_6,
            aes(x = Days_in_Treatment,
                y = Change_in_CEWL,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  labs(title = "Change in CEWL Relative to Number of Days in Treatment",
       x = "Days in Treatment",
       y = "Change in CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

###Figure: The change in CEWL relative to the number of days in treatment separated out by if the snake gave birth and treatment
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_6,
            aes(x = Days_in_Treatment,
                y = Change_in_CEWL,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  facet_wrap(~Gave_Birth + Hydration_Trmt)+
theme_classic() +
  labs(title = "Change in CEWL Relative to Number of Days in Treatment",
       subtitle = "By treatment group and if snake gave birth",
       x = "Days in Treatment",
       y = "Change in CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

###Figure: The Change in CEWL relative to days in treatment separated out by if snake gave birth
```{r}
ggplot() +
  geom_line(data = mother_data_all_final_6,
            aes(x = Days_in_Treatment,
                y = Change_in_CEWL,
                color = Hydration_Trmt,
                group = Indiv_ID),
            alpha = 1) +
  facet_wrap(~Gave_Birth)+
  theme_classic() +
  labs(title = "Change in CEWL Relative to Number of Days in Treatment",
       subtitle = "By if snake gave birth",
       x = "Days in Treatment",
       y = "Change in CEWL",
       color = "Treatment") +
  scale_color_discrete(name = "Treatment", labels = c("Control", "Hydration"))
```

#Thermocouple Calibration

First, I need to change an error in the data that has a body temperature of 75.5 for an individual measurement for snake 124. Should be 25.5.
```{r}
mother_data_all_final_6[55, 4] <- 25.5
```


Calibrating the body temperature data so that we know the recorded temperatures are accurate.

Uploading the csv files that has the thermocouple calibration data on it and the thermocouple reference sheet. Joining them together. 
```{r}
setwd("/Users/robinbedard/Desktop/Thesis/csv files")
thermo_c <- read.csv("thermoc_calibration.csv")
thermo_coupl <- thermo_c %>%
  dplyr::select(Time, Value) %>% 
  mutate(Time = as.POSIXct(substr(Time, 1,5), format = "%H:%M"))

thermo_ref <- read.csv("thermalcouple_c_reference.csv") %>% 
  mutate(Time = as.POSIXct(Time, format = "%H:%M"))

thermo_c_final <- left_join(thermo_coupl, thermo_ref, by = "Time")
```

Calibrate Thermocouple Data:
First, calculate and save regression curves..
```{r}
# calculate regression curves
regression_a <- lm(data = thermo_c_final,
                   Value ~ Temp)

# create df to store calibration equations
TC_calibration <- data.frame(TC_A = (coef(regression_a))) %>%
  `rownames<-`(c("intercept", "slope"))

#Next, use calibration curves to correct the data we measured:
# this applies respective calibration equation
# to all cloacal thermocouple data points of that proper thermocouple
# 2=slope & 1=intercept

mother_data_all_final_7 <- mother_data_all_final_6 %>%
  mutate(calibrated_cloacal_temp = Tb_at_CEWL*TC_calibration$TC_A[2] +
           TC_calibration$TC_A[1])

summary(mother_data_all_final_7)
```

Now I have a new column with the calibrated cloacal temperature at the time the measurement was taken. 

#Body Condition
Getting the log of SVL and the log of Mass
```{r}
mother_data_all_final_8 <- mother_data_all_final_7 %>%
  mutate(log_Mass = log10(Mass_g)) %>%
  mutate(log_SVL = log10(SVL_cm))

ggplot(data = mother_data_all_final_8, aes(x = log_SVL, y = log_Mass)) +
  geom_point()

bc_lm <- lm(data = mother_data_all_final_8, log_Mass ~ log_SVL)
mother_data_all_final_8$Body_Condition <- bc_lm$resid
```


```{r}
temp_MOM <- mother_data_all_final_8[ , c(1, 5, 12, 13, 17, 23)]

```

#Plotting Osmolarity Raw Data 
##Osmolarity vs. SVL
```{r}
ggplot(data = mother_data_all_final_8, aes(x = SVL_cm, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "SVL (cm)", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Mass
```{r}
ggplot(data = mother_data_all_final_8, aes(x = Mass_g, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Mass (g)", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Shed Stage
```{r}
ggplot(data = mother_data_all_final_8, aes(x = Shed_Stage, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_boxplot() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Shed Stage", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Cloacal Temp
```{r}
ggplot(data = mother_data_all_final_8, aes(x = calibrated_cloacal_temp, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Cloacal Temp at Time of Sample Collection", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Sample Collect Date
```{r}
ggplot(data = mother_data_all_final_8, aes(x = CEWL_Blood_Collect_Date, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Sample Collection Date", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Rookery Capture ID
This only includes the measurements for the day after capture. 
```{r}
filter(mother_data_all_final_8, Preg_Stage == "DAC") %>%
  ggplot(aes(x = Rookery_Capture_ID, y = Plasma_Osmol_Rep_mean)) +
  geom_boxplot() +
  theme_classic() +
  labs(x = "Rookery Capture Location", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Hydration Treatment
This includes the initial measurements before the treatments began and after.
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean)) +
  geom_boxplot() +
  theme_classic() +
  labs(x = "Hydration Treatment", y = "Plasma Osmolarity (mmol/kg)")
```

This does not include the initial measurements so is only the measurements after the hydration treatment began
```{r}
filter(mother_data_all_final_8, Preg_Stage != "DAC") %>%
  ggplot(aes(x = Hydration_Trmt, y = Plasma_Osmol_Rep_mean)) +
  geom_boxplot() +
  theme_classic() +
  labs(x = "Hydration Treatment", y = "Plasma Osmolarity (mmol/kg) After Treatment began")
```

##Osmolarity vs. CEWL
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = CEWL_g_m2h, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "CEWL", y = "Plasma Osmolarity (mmol/kg)")
```

##Osmolarity vs. Ambient Temp
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = msmt_temp_C, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Ambient Temp (C)", y = "Plasma Osmolarity (mmol/kg)")
```
##Osmolarity vs. Day Relative to the Day of Birth
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Day_Relative, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Day Relative to the Day of Birth", y = "Plasma Osmolarity (mmol/kg)")
```
##Osmolarity vs. Days in Treatment
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Days_in_Treatment, y = Plasma_Osmol_Rep_mean, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Number of Days in Treatment", y = "Plasma Osmolarity (mmol/kg)")
```


#Plotting CEWL Raw Data

##CEWL vs. SVL
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = SVL_cm, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "SVL (cm)", y = "CEWL (g/m2h)")
```
##CEWL vs. Mass
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Mass_g, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Mass (g)", y = "CEWL (g/m2h)")
```
##CEWL vs. Shed Stage
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Shed_Stage, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  geom_boxplot() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Shed Stage", y = "CEWL (g/m2h)")
```
##CEWL vs. Clocal Temp
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = calibrated_cloacal_temp, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Body Temp (C)", y = "CEWL (g/m2h)")
```
##CEWL vs. Body Condition
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Body_Condition, y = CEWL_g_m2h)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Body Condition", y = "CEWL (g/m2h)")
```
##CEWL vs. Sample Collect Date
```{r}
ggplot(data = mother_data_all_final_8, aes(x = CEWL_Blood_Collect_Date, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Sample Collection Date", y = "CEWL")
```
##CEWL vs. Rookery Capture ID
This only includes the measurements for the day after capture. 
```{r}
filter(mother_data_all_final_8, Preg_Stage == "DAC") %>%
  ggplot(aes(x = Rookery_Capture_ID, y = CEWL_g_m2h)) +
  geom_boxplot() +
  theme_classic() +
  labs(x = "Rookery Capture Location", y = "CEWL")
```
##CEWL vs. Hydration Treatment
This includes the initial measurements before the treatments began and after.
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Hydration_Trmt, y = CEWL_g_m2h)) +
  geom_boxplot() +
  theme_classic() +
  labs(x = "Hydration Treatment", y = "CEWL")
```
This does not include the initial measurements so is only the measurements after the hydration treatment began
```{r}
filter(mother_data_all_final_8, Preg_Stage != "DAC") %>%
  ggplot(aes(x = Hydration_Trmt, y = CEWL_g_m2h)) +
  geom_boxplot() +
  theme_classic() +
  labs(x = "Hydration Treatment", y = "CEWL After Treatment began")
```
##CEWL vs Osmolarity
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Plasma_Osmol_Rep_mean, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Plasma Osmolarity (mmol/kg)", y = "CEWL")
```
##CEWL vs. Ambient Temp
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = msmt_temp_C, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Ambient Temp (C)", y = "CEWL")
```
##CEWL vs. Day Relative to the Day of Birth
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Day_Relative, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Day Relative to the Day of Birth", y = "CEWL")
```
##CEWL vs. Days in Treatment
```{r}
  ggplot(data = mother_data_all_final_8, aes(x = Days_in_Treatment, y = CEWL_g_m2h, colour = Hydration_Trmt)) +
  geom_point() +
  theme_classic() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Number of Days in Treatment", y = "CEWL")
```

#Correlation Plot
Making a correlation plot to see which numerical variables are related to one another in this data set.

First, selecting out all of the numerical variables since correlation plots are based on numerical variables only.
```{r}
summary(mother_data_all_final_8)

correl_df <- mother_data_all_final_8 %>%
  mutate(Indiv_ID = as.numeric(Indiv_ID)) %>%
  ungroup() %>%
  dplyr::select(Plasma_Osmol_Rep_mean, SVL_cm, Mass_g, calibrated_cloacal_temp, CEWL_g_m2h, msmt_temp_C, msmt_RH_percent, Body_Condition, Day_Relative, Days_in_Treatment, Change_in_osmol, Change_in_CEWL)
```

Making the correlation chart
```{r}
chart.Correlation(correl_df, histogram=TRUE, pch=19)
```

#CEWL Models
##Categorical Variable Relationships
First, I have to find which categorical variables are related to CEWL.
```{r}
summary(mother_data_all_final_8)

#Shed stage 
summary(lm(CEWL_g_m2h ~ Shed_Stage, data = mother_data_all_final_8))
#not correlated, no need to include in model

#Preg_Stage
TukeyHSD(aov(CEWL_g_m2h ~ Preg_Stage, data = mother_data_all_final_8))
#Some differences, but this variable isnt biologically relavent. I really don't need it anyore. Doesn't accurately represent preg stage.

#Sample collect dater
TukeyHSD(aov(CEWL_g_m2h ~ as.factor(CEWL_Blood_Collect_Date), mother_data_all_final_8))
#Some difference. I'll include it but I think it is going to cause issues. 

#Rookery capture ID
TukeyHSD(aov(CEWL_g_m2h ~ Rookery_Capture_ID, data = mother_data_all_final_8))
#No differences, no need to include in the model

#Hydration treatment
summary(lm(CEWL_g_m2h ~ Hydration_Trmt, data = mother_data_all_final_8))
TukeyHSD(aov(CEWL_g_m2h ~ Hydration_Trmt, data = mother_data_all_final_8))
#Initial lm, no difference between hydration groups but I will still keep it in the model because this is what we are primarily interested in. Likely differences with interactions. 

#Date of parturition
TukeyHSD(aov(CEWL_g_m2h ~ as.factor(Date_Parturition), mother_data_all_final_8))
#No differences between the dates of parturition, wont include in model.

#If they gave birth or not
summary(lm(CEWL_g_m2h ~ Gave_Birth, data = mother_data_all_final_8))
#no difference, wont include in the model
```
Overall, the categorial variables that I will include in the model are collect date and hydration treatment.

##Numerical Variable Relationships

Based on the correlation plot, the numerical variables that I initially want to include in the full model for CEWL are calibrated body temp, ambient temp, ambient humidity, day relative to birth, and days in treatment

Overall, all of the variables that I will include in the initial model are calibrated body temp, ambient temp, ambient humidity, day relative to birth, days in treatment, hydration treatment, and sample collect date. I will also include the interactions that I think may be relevant. 

Since day relative is important, I will also have to make two separate models for the snakes that gave birth and the snakes that didn't. If, in the end, the best model for the snakes that did give birth doesn't include the day relative, then I can put all snakes in the same model. If not, separate. 

First, making a dataframe with the snakes that did give birth. 
```{r}
birth_snakes <- mother_data_all_final_8 %>%
  filter(Gave_Birth == "Y")
```

Now, a dataframe with the snakes that did not give birth
```{r}
no_birth_snakes <- mother_data_all_final_8 %>%
  filter(Gave_Birth == "N")
```

##Initial Models 
###Snakes that DID give birth
```{r}
BirthSnakes_CEWL_LMM_1 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        Hydration_Trmt *
                        (Day_Relative + Days_in_Treatment) +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_1)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_1)
anova(BirthSnakes_CEWL_LMM_1)
```
Lower AIC is better. So the row "AIC" shows what the AIC would be if that variable was dropped from the model. So, if a variable is outside of the +/- 2 range and the value would be lower if dropped, then it should be taken out of the model. When looking at the AIC, you want to drop the lowest AIC's that are outside of the +/- 2 range from the "none" dropped AIC. Then, rerun the model and do it again to see if any others should be dropped after dropping that one. Continue process until no more can be dropped or until no more are outside of the +/- 2 range. Once none are outside of that range, you create two models that are equivalent in their predicitive power. One is just simpler than the other one. 

I will be dropping variables from the model according to the AIC scores of drop 1. I will continue making models and dropping until I reach the null model. Then I will compare models with model selection for the snakes that did give birth. 

Based on model 1, the first variable that should be dropped is either interaction. Since the interaction between hydraton treatment and day relative is less significant than the other interaction, I will dropped that first. I will still keep the individual variables. 

```{r}
BirthSnakes_CEWL_LMM_2 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_2)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_2)
anova(BirthSnakes_CEWL_LMM_2)
```
Based on model 2, the next variable that should be dropped is day relative. 
```{r}
BirthSnakes_CEWL_LMM_3 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_3)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_3)
anova(BirthSnakes_CEWL_LMM_3)
```
Based on model 3, the next variable that should be dropped is the interaction between hydration treatment and days in treatment. I will remove the interaction but keep the individual effects. 
```{r}
BirthSnakes_CEWL_LMM_4 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        Days_in_Treatment +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_4)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_4)
anova(BirthSnakes_CEWL_LMM_4)
```
Based on model 4, the next variable that should be dropped is days in treatment. 
```{r}
BirthSnakes_CEWL_LMM_5 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_5)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_5)
anova(BirthSnakes_CEWL_LMM_5)
```
Based on model 5, the next variable that should be dropped is hydration treatment
```{r}
BirthSnakes_CEWL_LMM_6 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_6)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_6)
anova(BirthSnakes_CEWL_LMM_6)
```
Based on model 6, the next variable that should be dropped is body temp. 
```{r}
BirthSnakes_CEWL_LMM_7 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_7)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_7)
anova(BirthSnakes_CEWL_LMM_7)
```
Based on model 7, the next variable that should be dropped is ambient temp
```{r}
BirthSnakes_CEWL_LMM_8 <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_8)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_8)
anova(BirthSnakes_CEWL_LMM_8)
```
Null model 
```{r}
BirthSnakes_CEWL_LMM_null <- lme4::lmer(data = birth_snakes,
                      CEWL_g_m2h ~ 1 +
                        (1|Indiv_ID))

summary(BirthSnakes_CEWL_LMM_null)
#Lower t values are less significant
drop1(BirthSnakes_CEWL_LMM_null)
anova(BirthSnakes_CEWL_LMM_null)
```
####Model Selection
```{r CEWL mod compare}
cewl_models <- list(BirthSnakes_CEWL_LMM_1, BirthSnakes_CEWL_LMM_2, BirthSnakes_CEWL_LMM_3, BirthSnakes_CEWL_LMM_4, BirthSnakes_CEWL_LMM_5, BirthSnakes_CEWL_LMM_6, BirthSnakes_CEWL_LMM_7, BirthSnakes_CEWL_LMM_8, BirthSnakes_CEWL_LMM_null)

#specify model names
cewl_mod_names <- c('model1', 
                    'model2', 
                    'model3',
                    'model4',
                    'model5',
                    'model6',
                    'model7',
                    'model8',
                    'modelnull')

#calculate AIC of each model
cewl_AICc <- data.frame(aictab(cand.set = cewl_models, 
                                 modnames = cewl_mod_names))
cewl_AICc
```
So the best model is 7 and 5 and 6 being equivalent. Since day relative is not in any of those models, I can have the snakes that gave birth and the snakes that did not in the same model. I will not be making a separate model for the snakes that did not give birth. Below will be the model with ALL snakes. This will be the model used for the final analysis. 

###ALL Snakes 
```{r}
CEWL_LMM_1 <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        Hydration_Trmt *
                        (Days_in_Treatment) +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_1)
#Lower t values are less significant
drop1(CEWL_LMM_1)
anova(CEWL_LMM_1)
```
Lower AIC is better. So the row "AIC" shows what the AIC would be if that variable was dropped from the model. So, if a variable is outside of the +/- 2 range and the value would be lower if dropped, then it should be taken out of the model. When looking at the AIC, you want to drop the lowest AIC's that are outside of the +/- 2 range from the "none" dropped AIC. Then, rerun the model and do it again to see if any others should be dropped after dropping that one. Continue process until no more can be dropped or until no more are outside of the +/- 2 range. Once none are outside of that range, you create two models that are equivalent in their predicitive power. One is just simpler than the other one. 

I will be dropping variables from the model according to the AIC scores of drop 1. I will continue making models and dropping until I reach the null model.

Based on model 1, the first variable that should be dropped is the interaction between hydration treatment and days in treatment. I will still keep thier individual effects. 
```{r}
CEWL_LMM_2 <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        Days_in_Treatment +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_2)
#Lower t values are less significant
drop1(CEWL_LMM_2)
anova(CEWL_LMM_2)
```
Based on model 2, the next variable that should be dropped is days in treatment. 
```{r}
CEWL_LMM_3 <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_3)
#Lower t values are less significant
drop1(CEWL_LMM_3)
anova(CEWL_LMM_3)
```
Based on model 3, the next variable that should be dropped is body temp. 
```{r}
CEWL_LMM_4 <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_4)
#Lower t values are less significant
drop1(CEWL_LMM_4)
anova(CEWL_LMM_4)
```
Based on model 4, the next variable that should be dropped is hydration treatment
```{r}
CEWL_LMM_5 <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_5)
#Lower t values are less significant
drop1(CEWL_LMM_5)
anova(CEWL_LMM_5)
```
Based on model 5, the next variable that should be dropped is ambient temp. 
```{r}
CEWL_LMM_5 <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_5)
#Lower t values are less significant
drop1(CEWL_LMM_5)
anova(CEWL_LMM_5)
```
Null model
```{r}
CEWL_LMM_null <- lme4::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~ 1 +
                        (1|Indiv_ID))

summary(CEWL_LMM_null)
#Lower t values are less significant
drop1(CEWL_LMM_null)
anova(CEWL_LMM_null)
```
####Model Selection
```{r CEWL mod compare}
cewl_models_all <- list(CEWL_LMM_1, CEWL_LMM_2, CEWL_LMM_3, CEWL_LMM_4, CEWL_LMM_5, CEWL_LMM_null)

#specify model names
cewl_mod_names_all <- c('model1', 
                    'model2', 
                    'model3',
                    'model4',
                    'model5',
                    'modelnull')

#calculate AIC of each model
cewl_AICc_all <- data.frame(aictab(cand.set = cewl_models_all, 
                                 modnames = cewl_mod_names_all))
cewl_AICc_all
```
####Final Model

The best model is model 4 that includes ambient temp and humidity as predictors. There are no equivalent models but model 3 is very close. 

```{r}
CEWL_LMM_Final <- lmerTest::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_Final)
anova(CEWL_LMM_Final, type = "3", ddf = "Kenward-Roger")
car::vif(CEWL_LMM_Final)

#library('emmeans') 
#emtrends(CEWL_LMM_Final, "tmt", var = "day_n")

#effect size (fancy estimate) and CI of effect size. Effect size = same interpretation as estimate, uses marginal means. To talk about rate of change. 
```
CEWL has positive relationships with ambient temp and humidity and was higher for snakes in the hydration treatment (estimate = 2.14, SE = 0.89, F(1, 27) = 5.69, p = 0.02) others p < 0.0001.

On average cewl for snakes in hydration was 2.14 units higher 
for every 1 increase in ambient temp water loss increased by 2.7


```{r}
CEWL_LMM_SecondBest <- lmerTest::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        Hydration_Trmt +
                        calibrated_cloacal_temp +
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(CEWL_LMM_SecondBest)
```
Interpretation of CEWL_LMM_SecondBest model result:


####Linear Model Assumptions
```{r model assumptions}
car::vif(CEWL_LMM_Final)
plot(CEWL_LMM_Final)
plot(residuals(CEWL_LMM_Final))
shapiro.test(residuals(CEWL_LMM_Final))
#doesn't deviate from normality 
```
####Export
 
First, re-run for p-values:


```{r osmolality best models}
cewl_model_final_p <- lmerTest::lmer(data = mother_data_all_final_8,
                      CEWL_g_m2h ~
                        msmt_temp_C +
                        msmt_RH_percent +
                        (1|Indiv_ID))

summary(cewl_model_final_p)
```




#Osmolarity Models

##Categorical Variable Relationships
First, I have to find which categorical variables are related to osmolarity. 
```{r}
summary(mother_data_all_final_8)

#Shed stage 
summary(lm(Plasma_Osmol_Rep_mean ~ Shed_Stage, data = mother_data_all_final_8))
#not correlated, no need to include in model

#Preg_Stage
TukeyHSD(aov(Plasma_Osmol_Rep_mean ~ Preg_Stage, data = mother_data_all_final_8))
#No differences, no need to include in model

#Sample collect dater
TukeyHSD(aov(Plasma_Osmol_Rep_mean ~ as.factor(CEWL_Blood_Collect_Date), mother_data_all_final_8))
#No differences, no need to include in the model

#Rookery capture ID
TukeyHSD(aov(Plasma_Osmol_Rep_mean ~ Rookery_Capture_ID, data = mother_data_all_final_8))
#No differences, no need to include in the model

#Hydration treatment
summary(lm(Plasma_Osmol_Rep_mean ~ Hydration_Trmt, data = mother_data_all_final_8))
TukeyHSD(aov(Plasma_Osmol_Rep_mean ~ Hydration_Trmt, data = mother_data_all_final_8))
#Initial lm, no difference between hydration groups but I will still keep it in the model because this is what we are primarily interested in. 

#Date of parturition
TukeyHSD(aov(Plasma_Osmol_Rep_mean ~ as.factor(Date_Parturition), mother_data_all_final_8))
#No differences between the dates of parturition, wont include in model.

#If they gave birth or not
summary(lm(Plasma_Osmol_Rep_mean ~ Gave_Birth, data = mother_data_all_final_8))
#no difference, wont include in the model
```
Overall, the categorical variables that need to be included in the initial full model is only hydration treatment. 

##Numerical Variable Relationships
Based on the correlation plot, the numerical variables that I initially want to include in the full model for osmolatity are SVL, mass, cloacal temp, day relative to the day they gave birth.

So, all of the variables that will be included in the initial model for osmolarity are SVL, mass, cloacal temp, day relative to the day they gave birth, and hydration treatment. I will also start with all of the interactions that I think are relevant. 

##Initial Models

I am making two different models for snakes that did give birth and snakes that did not give birth. This is because I ran into the issue of the variable of day relative to the days that the snakes gave birth. The snakes that did not give birth had NAs which causes problems in the model. So, I am going to make two separate models for the snakes that gave birth and the ones that did not. The, if day relative ends up not being significant in the model for the snakes that did give birth, I can run them together in the same model. 

Oops, looks like there is an error for snake 117. Individual 117 is maked Y did give birth but did not. Recoding 117 to be N 
```{r}
mother_data_all_final_8[44:46, 18] <- "N"
```


First, making a dataframe with the snakes that did give birth. 
```{r}
birth_snakes <- mother_data_all_final_8 %>%
  filter(Gave_Birth == "Y")
```

Now, a dataframe with the snakes that did not give birth
```{r}
no_birth_snakes <- mother_data_all_final_8 %>%
  filter(Gave_Birth == "N")
```

###Snakes that DID give birth

The variables that will be included in the initial model for osmolarity are SVL, mass, cloacal temp, day relative to the day they gave birth, and hydration treatment. I will also start with all of the interactions that I think are relevant. 
```{r}
BirthSnakes_LMM_1 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + Day_Relative + CEWL_g_m2h) +
                        SVL_cm +
                        Mass_g +
                        calibrated_cloacal_temp +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_1)
#Lower t values are less significant
drop1(BirthSnakes_LMM_1)
anova(BirthSnakes_LMM_1)
```
Lower AIC is better. So the row "AIC" shows what the AIC would be if that variable was dropped from the model. So, if a variable is outside of the +/- 2 range and the value would be lower if dropped, then it should be taken out of the model. When looking at the AIC, you want to drop the lowest AIC's that are outside of the +/- 2 range from the "none" dropped AIC. Then, rerun the model and do it again to see if any others should be dropped after dropping that one. Continue process until no more can be dropped or until no more are outside of the +/- 2 range. Once none are outside of that range, you create two models that are equivalent in their predicitive power. One is just simpler than the other one. 

I will be dropping variables from the model according to the AIC scores of drop 1. I will continue making models and dropping until I reach the null model. Then I will compare models with model selection for the snakes that did give birth. 

Based on model 1, the first variable that should be dropped is mass. Without mass dropped the AIC is 443.32. With mass dropped the AIC is 441.35. 
```{r}
BirthSnakes_LMM_2 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + Day_Relative + CEWL_g_m2h) +
                        SVL_cm +
                        calibrated_cloacal_temp +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_2)
#Lower t values are less significant
drop1(BirthSnakes_LMM_2)
anova(BirthSnakes_LMM_2)
```
Based on model 2, the next variable that should be dropped is the interaction between hydration treatment and the day relative to the day they gave birth. I will still keep the individual effects in, but take out the interaction. The AIC without dropping the interaction is 441.35. The AIC with dropping it is 441.63. 

```{r}
BirthSnakes_LMM_3 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + CEWL_g_m2h) +
                        SVL_cm +
                        calibrated_cloacal_temp +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_3)
#Lower t values are less significant
drop1(BirthSnakes_LMM_3)
anova(BirthSnakes_LMM_3)
```
Based on model 3, the next variable that should be dropped is body temperature. Without dropping this variable the AIC is 439.41. With dropping it, the AIC is 437.53. Day relative does seem to be important. Likely that I will need two different models for the snakes that did give birth and the snakes that didn't 
```{r}
BirthSnakes_LMM_4 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + CEWL_g_m2h) +
                        SVL_cm +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_4)
#Lower t values are less significant
drop1(BirthSnakes_LMM_4)
anova(BirthSnakes_LMM_4)
?isSingular
```
Based on model 4, the next variable that should be dropped is SVL. AIC without dropping is 437.53. AIC with dropping is 435.85. 
```{r}
BirthSnakes_LMM_5 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + CEWL_g_m2h) +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_5)
#Lower t values are less significant
drop1(BirthSnakes_LMM_5)
anova(BirthSnakes_LMM_5)
?isSingular
```
Now I am at the point where dropping variables will not improve the AIC. However, this doesn't show what the effect of dropping the individual effects of the variables does. I am going to look at that next. It appears that individual effects of cewl and hydration treatment are not too important but they are important for the interactive effects. 
```{r}
BirthSnakes_LMM_6 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        (Hydration_Trmt :
                        Days_in_Treatment) +
                        Days_in_Treatment +
                        (Hydration_Trmt :
                        CEWL_g_m2h) +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_6)
#Lower t values are less significant
drop1(BirthSnakes_LMM_6)
anova(BirthSnakes_LMM_6)
```
This looks pretty good without the individual effects of cewl and hydration treatment and only having them in the interactions. I need to still get to the null model. So first, I will drop the interaction between hydration treatment and cewl.
```{r}
BirthSnakes_LMM_7 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        (Hydration_Trmt :
                        Days_in_Treatment) +
                        Days_in_Treatment +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_7)
#Lower t values are less significant
drop1(BirthSnakes_LMM_7)
anova(BirthSnakes_LMM_7)
```
Based on model 7, the next variable to drop is the interaction between hydration treatment and days in treatment.
```{r}
BirthSnakes_LMM_8 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Days_in_Treatment +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_8)
#Lower t values are less significant
drop1(BirthSnakes_LMM_8)
anova(BirthSnakes_LMM_8)
```
Based on model 8, the last variable to drop is the days in treatment. 
```{r}
BirthSnakes_LMM_9 <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_9)
#Lower t values are less significant
drop1(BirthSnakes_LMM_9)
anova(BirthSnakes_LMM_9)
```

Null model
```{r}
BirthSnakes_LMM_null <- lme4::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~ 1 +
                        (1|Indiv_ID))

summary(BirthSnakes_LMM_null)
#Lower t values are less significant
drop1(BirthSnakes_LMM_null)
anova(BirthSnakes_LMM_null)
```


####Model Selection
```{r CEWL mod compare}
osmolarity_models <- list(BirthSnakes_LMM_1, BirthSnakes_LMM_2, BirthSnakes_LMM_3, BirthSnakes_LMM_4, BirthSnakes_LMM_5, BirthSnakes_LMM_6, BirthSnakes_LMM_7, BirthSnakes_LMM_8, BirthSnakes_LMM_9, BirthSnakes_LMM_null)

#specify model names
osmolarity_mod_names <- c('model1', 
                    'model2', 
                    'model3',
                    'model4',
                    'model5',
                    'model6',
                    'model7',
                    'model8',
                    'model9',
                    'modelnull')

#calculate AIC of each model
osmolarity_AICc <- data.frame(aictab(cand.set = osmolarity_models, 
                                 modnames = osmolarity_mod_names))
osmolarity_AICc
```
####Final Model
So the best model is this one. There are no equivalent models for the snakes that did give birth based on delta AICc. AKA there are none +/- 2 delta AICc. 
```{r}
BirthSnakes_Final_Model <- lmerTest::lmer(data = birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + 
                        CEWL_g_m2h) +
                        Day_Relative +
                        (1|Indiv_ID))

summary(BirthSnakes_Final_Model)
anova(BirthSnakes_Final_Model)
car::vif(BirthSnakes_Final_Model)
```

####Linear Model Assumptions
```{r model assumptions}
car::vif(BirthSnakes_Final_Model)
plot(BirthSnakes_Final_Model)
plot(residuals(BirthSnakes_Final_Model))
shapiro.test(residuals(BirthSnakes_Final_Model))

#How we want to look at relationship between ewl and osmolality
```

###Snakes that DID NOT give birth

The variables that will be included in the initial model for osmolarity are SVL, mass, cloacal temp, day relative to the day they gave birth, and hydration treatment. I will also start with all of the interactions that I think are relevant. The difference is that these snakes do not have a day relative variable. 
```{r}
No_BirthSnakes_LMM_1 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + CEWL_g_m2h) +
                        SVL_cm +
                        Mass_g +
                        calibrated_cloacal_temp +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_1)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_1)
anova(No_BirthSnakes_LMM_1)
```
I will be dropping variables from the model according to the AIC scores of drop 1. I will continue making models and dropping until I reach the null model. Then I will compare models with model selection for the snakes that did give birth. 

Based on model 1, the first variable that should be dropped is body temp. AIC without dropping is 244.60. AIC with dropping is 243.48. 
```{r}
No_BirthSnakes_LMM_2 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        (Days_in_Treatment + CEWL_g_m2h) +
                        SVL_cm +
                        Mass_g +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_2)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_2)
anova(No_BirthSnakes_LMM_2)
```
Based on model 2, the next variable that should be dropped is the interaction between hydration treatment and cewl. I will keep the inidividual effects in to see if it makes a difference. 
```{r}
No_BirthSnakes_LMM_3 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        SVL_cm +
                        Mass_g +
                        CEWL_g_m2h +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_3)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_3)
anova(No_BirthSnakes_LMM_3)
```
Based on model 3, the next variable that should be dropped is cewl. 
```{r}
No_BirthSnakes_LMM_4 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        SVL_cm +
                        Mass_g +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_4)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_4)
anova(No_BirthSnakes_LMM_4)
```
Based on model 4, the next variable that should be dropped is mass. 
```{r}
No_BirthSnakes_LMM_5 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        SVL_cm +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_5)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_5)
anova(No_BirthSnakes_LMM_5)
```
Based on model 5, the next variable that should be dropped is svl. 
```{r}
No_BirthSnakes_LMM_6 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_6)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_6)
anova(No_BirthSnakes_LMM_6)
```
A model with the interaction only without the inidividal effects: 
```{r}
No_BirthSnakes_LMM_7 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt :
                        Days_in_Treatment +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_7)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_7)
anova(No_BirthSnakes_LMM_7)
```
A model with only the individual effects and not the interaction
```{r}
No_BirthSnakes_LMM_8 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt +
                        Days_in_Treatment +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_8)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_8)
anova(No_BirthSnakes_LMM_8)
```
model with last variable dropped (days in tmt)
```{r}
No_BirthSnakes_LMM_9 <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_9)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_9)
anova(No_BirthSnakes_LMM_9)
```
Null model
```{r}
No_BirthSnakes_LMM_null <- lme4::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~ 1 +
                        (1|Indiv_ID))

summary(No_BirthSnakes_LMM_null)
#Lower t values are less significant
drop1(No_BirthSnakes_LMM_null)
anova(No_BirthSnakes_LMM_null)
```
####Model Selection
```{r CEWL mod compare}
osmolarity_models <- list(No_BirthSnakes_LMM_1, No_BirthSnakes_LMM_2, No_BirthSnakes_LMM_3, No_BirthSnakes_LMM_4, No_BirthSnakes_LMM_5, No_BirthSnakes_LMM_6, No_BirthSnakes_LMM_7, No_BirthSnakes_LMM_8, No_BirthSnakes_LMM_9, No_BirthSnakes_LMM_null)

#specify model names
osmolarity_mod_names <- c('model1', 
                    'model2', 
                    'model3',
                    'model4',
                    'model5',
                    'model6',
                    'model7',
                    'model8',
                    'model9',
                    'modelnull')

#calculate AIC of each model
osmolarity_AICc <- data.frame(aictab(cand.set = osmolarity_models, 
                                 modnames = osmolarity_mod_names))
osmolarity_AICc
```
####Final Model
So the best model for the snakes that did not give birth is below. There is no equavalent model.
```{r}
No_BirthSnakes_FinalModel <- lmerTest::lmer(data = no_birth_snakes,
                      Plasma_Osmol_Rep_mean ~
                        Hydration_Trmt *
                        Days_in_Treatment +
                        (1|Indiv_ID))

summary(No_BirthSnakes_FinalModel)
```

####Linear Model Conditions

```{r model assumptions}
car::vif(No_BirthSnakes_FinalModel)
plot(No_BirthSnakes_FinalModel)
shapiro.test(residuals(No_BirthSnakes_FinalModel))
```








